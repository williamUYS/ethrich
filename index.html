<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETHåˆçº¦å¼€ä»“ä»·ä½è®¡ç®—å™¨ - ä¸“ä¸šäº¤æ˜“å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            border-bottom: 1px solid #334155;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #6366f1, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            color: #94a3b8;
            font-size: 1.1rem;
            margin-top: 8px;
        }
        
        .calculator-container {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }
        
        .input-section {
            flex: 1;
            min-width: 300px;
            background: rgba(30, 41, 59, 0.85);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5), 0 8px 10px -6px rgba(0, 0, 0, 0.3);
            border: 1px solid #334155;
        }
        
        .result-section {
            flex: 1;
            min-width: 300px;
            background: rgba(24, 32, 48, 0.92);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.6), 0 8px 10px -6px rgba(0, 0, 0, 0.4);
            border: 1px solid #2d3748;
            display: flex;
            flex-direction: column;
        }
        
        .section-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #334155;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-size: 1.6rem;
        }
        
        .input-group {
            margin-bottom: 22px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #cbd5e1;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        label .tooltip {
            width: 18px;
            height: 18px;
            background: #4b5563;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            cursor: help;
            transition: all 0.2s;
        }
        
        label .tooltip:hover {
            background: #6366f1;
            transform: scale(1.1);
        }
        
        input, select {
            width: 100%;
            padding: 14px 18px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid #334155;
            border-radius: 10px;
            color: white;
            font-size: 1.15rem;
            margin-top: 6px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.25);
        }
        
        input::placeholder {
            color: #64748b;
        }
        
        .direction-group {
            display: flex;
            gap: 15px;
            margin-top: 8px;
        }
        
        .direction-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #334155;
            border-radius: 10px;
            background: rgba(30, 41, 59, 0.7);
            color: #94a3b8;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }
        
        .direction-btn.active {
            border-color: #6366f1;
            background: rgba(37, 99, 235, 0.15);
            color: #6366f1;
            font-weight: 600;
        }
        
        .direction-btn.long.active {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
        }
        
        .direction-btn.short.active {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.15);
            color: #ef4444;
        }
        
        .direction-btn i {
            font-size: 1.4rem;
            font-weight: bold;
        }
        
        .direction-btn.long i {
            color: #10b981;
        }
        
        .direction-btn.short i {
            color: #ef4444;
        }
        
        .calculate-btn {
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            width: 100%;
            padding: 16px 20px;
            font-size: 1.25rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.6);
        }
        
        .calculate-btn:active {
            transform: translateY(0);
        }
        
        .result-display {
            background: rgba(15, 23, 42, 0.95);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            margin-bottom: 25px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border: 1px solid #2d3748;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.5);
        }
        
        .result-label {
            font-size: 1.1rem;
            color: #94a3b8;
            margin-bottom: 12px;
        }
        
        .result-value {
            font-size: 3.2rem;
            font-weight: 700;
            background: linear-gradient(90deg, #6366f1, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            letter-spacing: -1px;
        }
        
        .result-subtext {
            color: #64748b;
            font-size: 0.95rem;
            margin-top: 8px;
            min-height: 24px;
        }
        
        .verification-section {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
            border: 1px solid #334155;
        }
        
        .verification-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            color: #cbd5e1;
            font-weight: 500;
        }
        
        .verification-steps {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #cbd5e1;
        }
        
        .verification-steps .step {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }
        
        .verification-steps .step:before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: #6366f1;
            font-weight: bold;
        }
        
        .risk-meter {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #334155;
        }
        
        .risk-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .risk-bar {
            height: 10px;
            background: #1e293b;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        
        .risk-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .risk-low { background: linear-gradient(90deg, #10b981, #34d399); }
        .risk-medium { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .risk-high { background: linear-gradient(90deg, #ef4444, #f87171); }
        
        .notes {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .notes h3 {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            color: #cbd5e1;
        }
        
        .notes ul {
            padding-left: 20px;
            margin-top: 8px;
        }
        
        .notes li {
            margin-bottom: 6px;
        }
        
        .highlight {
            background: rgba(99, 102, 241, 0.15);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #64748b;
            font-size: 0.9rem;
            padding: 20px;
            border-top: 1px solid #334155;
        }
        
        @media (max-width: 768px) {
            .calculator-container {
                flex-direction: column;
            }
            
            body {
                padding: 15px;
            }
            
            .input-section, .result-section {
                min-width: 100%;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .result-value {
                font-size: 2.6rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âš¡ ETHåˆçº¦å¼€ä»“ä»·ä½è®¡ç®—å™¨</h1>
            <div class="subtitle">ä¸“ä¸šäº¤æ˜“å·¥å…· - ç²¾ç¡®è®¡ç®—å¼€ä»“ä»·ä½ï¼Œä¸¥æ ¼æ§åˆ¶é£é™©</div>
        </header>
        
        <div class="calculator-container">
            <div class="input-section">
                <h2 class="section-title">ğŸ“Š äº¤æ˜“å‚æ•°</h2>
                
                <div class="input-group">
                    <label for="margin">ä¿è¯é‡‘ (USDT) <span class="tooltip">?</span></label>
                    <input type="number" id="margin" value="50" step="0.01" min="0.01">
                </div>
                
                <div class="input-group">
                    <label for="maxLoss">æœ€å¤§å¯æ¥å—äºæŸ (USDT) <span class="tooltip">?</span></label>
                    <input type="number" id="maxLoss" value="10" step="0.01" min="0.01">
                </div>
                
                <div class="input-group">
                    <label for="stopPrice">æ­¢æŸä»·æ ¼ (USDT) <span class="tooltip">?</span></label>
                    <input type="number" id="stopPrice" value="2966.59" step="0.01" min="0.01">
                </div>
                
                <div class="input-group">
                    <label for="leverage">åˆçº¦å€ç‡ <span class="tooltip">?</span></label>
                    <input type="number" id="leverage" value="20" min="1" max="125">
                </div>
                
                <div class="input-group">
                    <label>äº¤æ˜“æ–¹å‘</label>
                    <div class="direction-group">
                        <div class="direction-btn long active" data-direction="long">
                            <span>åšå¤š</span>
                            <span>LONG</span>
                            <span>â†‘</span>
                        </div>
                        <div class="direction-btn short" data-direction="short">
                            <span>åšç©º</span>
                            <span>SHORT</span>
                            <span>â†“</span>
                        </div>
                    </div>
                </div>
                
                <button class="calculate-btn" id="calculateBtn">è®¡ç®—å¼€ä»“ä»·ä½</button>
                
                <div class="risk-meter">
                    <div class="risk-label">
                        <span>é£é™©æ°´å¹³</span>
                        <span id="riskLevel">ä½é£é™©</span>
                    </div>
                    <div class="risk-bar">
                        <div class="risk-fill risk-low" id="riskFill" style="width: 20%"></div>
                    </div>
                    <div class="risk-label">
                        <span>0%</span>
                        <span>100%</span>
                    </div>
                </div>
                
                <div class="notes">
                    <h3>ğŸ“Œ ä½¿ç”¨è¯´æ˜</h3>
                    <ul>
                        <li>è¾“å…¥æ‚¨çš„äº¤æ˜“å‚æ•°ï¼Œç‚¹å‡»"è®¡ç®—å¼€ä»“ä»·ä½"</li>
                        <li>åšå¤šæ—¶ï¼šæ­¢æŸä»·åº”ä½äºå¼€ä»“ä»·</li>
                        <li>åšç©ºæ—¶ï¼šæ­¢æŸä»·åº”é«˜äºå¼€ä»“ä»·</li>
                        <li>é£é™©æ°´å¹³åŸºäºäºæŸå ä¿è¯é‡‘æ¯”ä¾‹è®¡ç®—</li>
                        <li>æœ¬è®¡ç®—å™¨é€‚ç”¨äºUæœ¬ä½åˆçº¦äº¤æ˜“</li>
                    </ul>
                </div>
            </div>
            
            <div class="result-section">
                <h2 class="section-title">ğŸ¯ è®¡ç®—ç»“æœ</h2>
                
                <div class="result-display">
                    <div class="result-label">å»ºè®®å¼€ä»“ä»·æ ¼</div>
                    <div class="result-value" id="entryPrice">2937.22</div>
                    <div class="result-subtext" id="directionText">åšç©ºæ–¹å‘ - ä»·æ ¼ä½äºæ­¢æŸä½</div>
                </div>
                
                <div class="verification-section">
                    <div class="verification-title">âœ… éªŒè¯è®¡ç®—</div>
                    <div class="verification-steps" id="verificationSteps">
                        <div class="step">ä»·æ ¼å˜åŠ¨: (2966.59 - 2937.22) / 2937.22 = 1.00%</div>
                        <div class="step">æ æ†æ”¾å¤§äºæŸ: 1.00% Ã— 20 = 20.00%</div>
                        <div class="step">ä¿è¯é‡‘äºæŸ: 50 Ã— 20.00% = 10.00 USDT</div>
                        <div class="step">å®é™…äºæŸä¸è®¾å®šæœ€å¤§äºæŸåŒ¹é… âœ“</div>
                    </div>
                </div>
                
                <div class="notes" style="margin-top: 20px;">
                    <h3>âš ï¸ é£é™©æç¤º</h3>
                    <ul>
                        <li>å®é™…äº¤æ˜“ä¸­éœ€è€ƒè™‘æ‰‹ç»­è´¹å’Œæ»‘ç‚¹å½±å“</li>
                        <li>å»ºè®®ä½¿ç”¨æ ‡è®°ä»·æ ¼è®¾ç½®æ­¢æŸå•ï¼Œé¿å…æ’é’ˆ</li>
                        <li>å•ç¬”äºæŸå»ºè®®æ§åˆ¶åœ¨æ€»èµ„é‡‘çš„1-2%ä»¥å†…</li>
                        <li>é«˜æ æ†äº¤æ˜“é£é™©æé«˜ï¼Œè°¨æ…ä½¿ç”¨</li>
                        <li>æœ¬è®¡ç®—å™¨ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <footer>
            <p>ETHåˆçº¦å¼€ä»“ä»·ä½è®¡ç®—å™¨ v1.0 | ä¸“ä¸šäº¤æ˜“å·¥å…· | æ•°æ®ä»…åœ¨æœ¬åœ°è®¡ç®—ï¼Œä¸ä¼šä¸Šä¼ ä»»ä½•æœåŠ¡å™¨</p>
            <p style="margin-top: 8px; font-size: 0.85rem; color: #4b5563;">Â© 2023 Crypto Trading Tools. All rights reserved.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOMå…ƒç´ 
            const marginInput = document.getElementById('margin');
            const maxLossInput = document.getElementById('maxLoss');
            const stopPriceInput = document.getElementById('stopPrice');
            const leverageInput = document.getElementById('leverage');
            const calculateBtn = document.getElementById('calculateBtn');
            const entryPriceDisplay = document.getElementById('entryPrice');
            const directionText = document.getElementById('directionText');
            const verificationSteps = document.getElementById('verificationSteps');
            const riskFill = document.getElementById('riskFill');
            const riskLevel = document.getElementById('riskLevel');
            const directionBtns = document.querySelectorAll('.direction-btn');
            
            // é»˜è®¤æ–¹å‘ä¸ºåšç©º
            let tradeDirection = 'short';
            
            // æ–¹å‘æŒ‰é’®äº‹ä»¶
            directionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    directionBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    tradeDirection = this.dataset.direction;
                    calculateEntryPrice();
                });
            });
            
            // è®¡ç®—æŒ‰é’®äº‹ä»¶
            calculateBtn.addEventListener('click', calculateEntryPrice);
            
            // è¾“å…¥å˜åŒ–æ—¶è‡ªåŠ¨è®¡ç®—ï¼ˆå¯é€‰ï¼‰
            [marginInput, maxLossInput, stopPriceInput, leverageInput].forEach(input => {
                input.addEventListener('change', calculateEntryPrice);
                input.addEventListener('keyup', function(e) {
                    if (e.key === 'Enter') calculateEntryPrice();
                });
            });
            
            // åˆå§‹è®¡ç®—
            calculateEntryPrice();
            
            function calculateEntryPrice() {
                // è·å–è¾“å…¥å€¼
                const margin = parseFloat(marginInput.value);
                const maxLoss = parseFloat(maxLossInput.value);
                const stopPrice = parseFloat(stopPriceInput.value);
                const leverage = parseFloat(leverageInput.value);
                
                // éªŒè¯è¾“å…¥
                if (isNaN(margin) || isNaN(maxLoss) || isNaN(stopPrice) || isNaN(leverage) || 
                    margin <= 0 || maxLoss <= 0 || stopPrice <= 0 || leverage <= 0) {
                    showError("è¯·è¾“å…¥æœ‰æ•ˆçš„æ­£æ•°å‚æ•°");
                    return;
                }
                
                if (maxLoss >= margin) {
                    showError("æœ€å¤§äºæŸä¸èƒ½å¤§äºæˆ–ç­‰äºä¿è¯é‡‘");
                    return;
                }
                
                // è®¡ç®—é£é™©æ°´å¹³
                const riskPercentage = (maxLoss / margin) * 100;
                updateRiskMeter(riskPercentage);
                
                let entryPrice;
                let verification = [];
                
                if (tradeDirection === 'short') {
                    // åšç©ºï¼šå¼€ä»“ä»· = æ­¢æŸä»· / (1 + (æœ€å¤§äºæŸ / (ä¿è¯é‡‘ * æ æ†)))
                    const denominator = 1 + (maxLoss / (margin * leverage));
                    entryPrice = stopPrice / denominator;
                    
                    // éªŒè¯æ­¥éª¤
                    const priceChangePercent = ((stopPrice - entryPrice) / entryPrice) * 100;
                    const leveragedLossPercent = priceChangePercent * leverage;
                    const actualLoss = margin * (leveragedLossPercent / 100);
                    
                    verification = [
                        `ä»·æ ¼å˜åŠ¨: (${stopPrice.toFixed(2)} - ${entryPrice.toFixed(2)}) / ${entryPrice.toFixed(2)} = ${priceChangePercent.toFixed(2)}%`,
                        `æ æ†æ”¾å¤§äºæŸ: ${priceChangePercent.toFixed(2)}% Ã— ${leverage} = ${leveragedLossPercent.toFixed(2)}%`,
                        `ä¿è¯é‡‘äºæŸ: ${margin} Ã— ${leveragedLossPercent.toFixed(2)}% = ${actualLoss.toFixed(2)} USDT`,
                        `âœ“ å®é™…äºæŸä¸è®¾å®šæœ€å¤§äºæŸåŒ¹é…`
                    ];
                    
                    directionText.textContent = "åšç©ºæ–¹å‘ - ä»·æ ¼ä½äºæ­¢æŸä½";
                } else {
                    // åšå¤šï¼šå¼€ä»“ä»· = æ­¢æŸä»· / (1 - (æœ€å¤§äºæŸ / (ä¿è¯é‡‘ * æ æ†)))
                    const ratio = maxLoss / (margin * leverage);
                    if (ratio >= 1) {
                        showError("å‚æ•°é”™è¯¯ï¼šæœ€å¤§äºæŸä¸èƒ½è¶…è¿‡ä¿è¯é‡‘ä¸æ æ†ä¹˜ç§¯");
                        return;
                    }
                    
                    const denominator = 1 - ratio;
                    entryPrice = stopPrice / denominator;
                    
                    // éªŒè¯æ­¥éª¤
                    const priceChangePercent = ((entryPrice - stopPrice) / entryPrice) * 100;
                    const leveragedLossPercent = priceChangePercent * leverage;
                    const actualLoss = margin * (leveragedLossPercent / 100);
                    
                    verification = [
                        `ä»·æ ¼å˜åŠ¨: (${entryPrice.toFixed(2)} - ${stopPrice.toFixed(2)}) / ${entryPrice.toFixed(2)} = ${priceChangePercent.toFixed(2)}%`,
                        `æ æ†æ”¾å¤§äºæŸ: ${priceChangePercent.toFixed(2)}% Ã— ${leverage} = ${leveragedLossPercent.toFixed(2)}%`,
                        `ä¿è¯é‡‘äºæŸ: ${margin} Ã— ${leveragedLossPercent.toFixed(2)}% = ${actualLoss.toFixed(2)} USDT`,
                        `âœ“ å®é™…äºæŸä¸è®¾å®šæœ€å¤§äºæŸåŒ¹é…`
                    ];
                    
                    directionText.textContent = "åšå¤šæ–¹å‘ - ä»·æ ¼é«˜äºæ­¢æŸä½";
                }
                
                // æ˜¾ç¤ºç»“æœ
                entryPriceDisplay.textContent = entryPrice.toFixed(2);
                
                // æ›´æ–°éªŒè¯æ­¥éª¤
                verificationSteps.innerHTML = '';
                verification.forEach(step => {
                    const div = document.createElement('div');
                    div.className = 'step';
                    div.textContent = step;
                    verificationSteps.appendChild(div);
                });
            }
            
            function updateRiskMeter(percentage) {
                // é™åˆ¶åœ¨0-100%
                percentage = Math.min(100, Math.max(0, percentage));
                
                riskFill.style.width = `${percentage}%`;
                
                // æ›´æ–°é£é™©ç­‰çº§å’Œé¢œè‰²
                if (percentage < 15) {
                    riskFill.className = 'risk-fill risk-low';
                    riskLevel.textContent = 'ä½é£é™©';
                } else if (percentage < 30) {
                    riskFill.className = 'risk-fill risk-medium';
                    riskLevel.textContent = 'ä¸­é£é™©';
                } else {
                    riskFill.className = 'risk-fill risk-high';
                    riskLevel.textContent = 'é«˜é£é™©';
                }
            }
            
            function showError(message) {
                entryPriceDisplay.textContent = 'é”™è¯¯';
                directionText.textContent = message;
                verificationSteps.innerHTML = `<div class="step" style="color: #ef4444;"> $ {message}</div>`;
                riskFill.style.width = '100%';
                riskFill.className = 'risk-fill risk-high';
                riskLevel.textContent = 'å‚æ•°é”™è¯¯';
            }
        });
    </script>
</body>
</html>